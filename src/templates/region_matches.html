{% extends "base.html" %}

{% block style %}
    <link rel="stylesheet" href="/static/css/styles_matches_season.css">
{% endblock %}

{% block aside_left %}
{% endblock %}

{% block content %}

    {% include "includes/nav_block.html" %}

    <div class="fiex justify-center flex-col items-center">
      <div class="league-statistic__table tab-content" style="width: 100%;">
        <div id="tab-league-statistic-main" class="tab-pane active">
          <table class="table table-striped table-hover" style="width: 100%;">
            <thead>
              <tr class="row-group-title">
                  <td class="col-fullwidth" colspan="9">{{ season.name }}</td>
              </tr>
              <tr class="row-header">
                    <th>Дата матчу</th>
                    <th>Раунд</th>
                    <th>Стадіон</th>
                    <th>Команда господар</th>
                    <th></th>
                    <th>Результат</th>
                    <th></th>
                    <th>Команда гість</th>
                    <th>Статус</th>
              </tr>
            </thead>
            <tbody>
            {% for match in matches %}
              <tr class="row-default">
                  <td><span class="match-date" data-epoch="{{ match.event }}"></span></td>
                  <td>{{ match.round.name }}</td>
                  <td>{{ match.stadium.name }} {{ match.stadium.city }}</td>
                  <td>
                    <a href="/teams/{{ match.team_1.id }}">
                      {{ match.team_1.name }} ({{ match.team_1.city }})
                    </a>
                  </td>
                  <td class="img-center">
                      <img src="{{ url_for('static', path='/img/teams/' ~ match.team_1.logo) }}" alt="{{ match.team_1.name }} logo">
                  </td>
                  <td align="center">
                     <strong>{{ match.team1_goals }} : {{ match.team2_goals }}</strong>
                        <br>
                          {% if match.team1_penalty %}
                             (п. {{ match.team1_penalty }} : {{ match.team2_penalty }})
                          {% endif %}
                  </td>
                  <td class="img-center">
                      <img src="{{ url_for('static', path='/img/teams/' ~ match.team_2.logo) }}" alt="{{ match.team_2.name }} logo">
                  </td>
                  <td>
                      <a href="/teams/{{ match.team_2.id }}">
                         {{ match.team_2.name }} ({{ match.team_2.city }})
                      </a>
                  </td>
                  <td>{{ match.status.value }}</td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
{% endblock %}

{% block aside_right %}
    <h5>Турнірна таблиця</h5>
    <div class="container mt-5">
      <table class="table table-striped">
        <thead>
          <tr class="row-header">
            <th scope="col">№</th>
            <th scope="col"></th>
            <th scope="col">Команда</th>
            <th scope="col">І</th>
            <th scope="col">В</th>
            <th scope="col">Н</th>
            <th scope="col">П</th>
            <th scope="col">О</th>
          </tr>
        </thead>
        <tbody>
          {% for team in standings %}
            <tr class="row-default">
              <th scope="row">{{ loop.index }}</th>
              <td class="img-center"><img src="{{ url_for('static', path='/img/teams/' ~ team.logo) }}" alt="{{ team.team_name }} logo"></td>
              <td>
                <a class="nav-link" href="/teams/{{ team.team_id }}">
                  <strong>{{ team.team_name }}</strong>
                  <br>({{ team.team_city }})
                </a>
              </td>
              <td align="center">{{ team.played }}</td>
              <td align="center">{{ team.won }}</td>
              <td align="center">{{ team.drawn }}</td>
              <td align="center">{{ team.lost }}</td>
              <td align="center"><strong>{{ team.points }}</strong></td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Отримати всі елементи з класом "match-date"
            const dateElements = document.querySelectorAll('.match-date');

            dateElements.forEach(element => {
                // Отримати значення epoch з атрибуту data-epoch
                const epochTime = parseInt(element.getAttribute('data-epoch'), 10);

                // Конвертувати epoch time у Date об'єкт
                const date = new Date(epochTime * 1000); // Epoch time в секундах, тому множимо на 1000

                // Форматувати дату у формат dd-mm-yyyy
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0'); // Місяці від 0 до 11
                const year = date.getFullYear();

                const formattedDate = `${day}-${month}-${year}`;

                // Встановити відформатовану дату у елемент
                element.textContent = formattedDate;
            });
        });
    </script>

{% endblock %}
